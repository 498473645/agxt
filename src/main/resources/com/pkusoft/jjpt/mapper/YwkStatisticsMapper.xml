<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pkusoft.jjpt.mapper.YwkStatisticsMapper">
	<resultMap id="ResultMap" type="com.pkusoft.lesp.po.StatisticsData">
		<result column="DATA01" jdbcType="INTEGER" property="data01" />
		<result column="DATA02" jdbcType="INTEGER" property="data02" />
		<result column="DATA03" jdbcType="INTEGER" property="data03" />
		<result column="DATA04" jdbcType="INTEGER" property="data04" />
		<result column="DATA05" jdbcType="INTEGER" property="data05" />
		<result column="DATA06" jdbcType="INTEGER" property="data06" />
		<result column="DATA07" jdbcType="INTEGER" property="data07" />
		<result column="DATA08" jdbcType="INTEGER" property="data08" />
		<result column="DATA09" jdbcType="INTEGER" property="data09" />
		<result column="DATA10" jdbcType="INTEGER" property="data10" />
		<result column="DATA11" jdbcType="INTEGER" property="data11" />
		<result column="DATA12" jdbcType="INTEGER" property="data12" />
		<result column="DATA13" jdbcType="INTEGER" property="data13" />
		<result column="DATA14" jdbcType="VARCHAR" property="data14" />
		<result column="DATA15" jdbcType="VARCHAR" property="data15" />
		<!-- <result column="DATA17" jdbcType="INTEGER" property="data17" />
		<result column="DATA18" jdbcType="INTEGER" property="data18" />
		<result column="DATA19" jdbcType="INTEGER" property="data19" />
		<result column="DATA20" jdbcType="INTEGER" property="data20" /> -->
	</resultMap>


	<select id="getSmbaData" resultMap="ResultMap" >
		select
		COUNT(1) as data01
		from PS_TRANS t
		where EXTRACT(YEAR FROM t.REP_TIME) = #{year,jdbcType=VARCHAR}
		<if test="month != null and month != ''">
			AND EXTRACT(MONTH FROM t.REP_TIME) = #{month,jdbcType=VARCHAR}
		</if>
		<if test="day != null and day != ''">
			AND EXTRACT(DAY FROM t.REP_TIME) = #{day,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '2'.toString()">
			AND OWN_ORG_2 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '3'.toString()">
			AND OWN_ORG_3 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '4'.toString()">
			AND OWN_ORG_4 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="ly != null and ly != ''">
			AND LY = #{ly,jdbcType=VARCHAR}
		</if>
	</select>


	<select id="getYbafsdbData" resultMap="ResultMap" >
		select
		COUNT(1) as  data01,t.DATA_TYPE as  data02
		from PS_TRANS t
		where EXTRACT(YEAR FROM t.REP_TIME) = #{year,jdbcType=VARCHAR}
		<if test="month != null and month != ''">
			AND EXTRACT(MONTH FROM t.REP_TIME) = #{month,jdbcType=VARCHAR}
		</if>
		<if test="day != null and day != ''">
			AND EXTRACT(DAY FROM t.REP_TIME) = #{day,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '2'.toString()">
			AND OWN_ORG_2 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '3'.toString()">
			AND OWN_ORG_3 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '4'.toString()">
			AND OWN_ORG_4 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="ly != null and ly != ''">
			AND LY = #{ly,jdbcType=VARCHAR}
		</if>
		GROUP BY t.DATA_TYPE
	</select>


	<select id="getYbaclztfxData" resultMap="ResultMap" >
		select
		COUNT(1) as  data01,t.STATUS as  data02
		from PS_TRANS t
		where EXTRACT(YEAR FROM t.REP_TIME) = #{year,jdbcType=VARCHAR}
		<if test="month != null and month != ''">
			AND EXTRACT(MONTH FROM t.REP_TIME) = #{month,jdbcType=VARCHAR}
		</if>
		<if test="day != null and day != ''">
			AND EXTRACT(DAY FROM t.REP_TIME) = #{day,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '2'.toString()">
			AND OWN_ORG_2 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '3'.toString()">
			AND OWN_ORG_3 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '4'.toString()">
			AND OWN_ORG_4 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="ly != null and ly != ''">
			AND LY = #{ly,jdbcType=VARCHAR}
		</if>
		GROUP BY t.STATUS
	</select>


	<select id="getBalxData" resultMap="ResultMap" >
		select
		COUNT(1) as  data01,t.TYPE as  data15
		from PS_TRANS t
		where EXTRACT(YEAR FROM t.REP_TIME) = #{year,jdbcType=VARCHAR}
		<if test="month != null and month != ''">
			AND EXTRACT(MONTH FROM t.REP_TIME) = #{month,jdbcType=VARCHAR}
		</if>
		<if test="day != null and day != ''">
			AND EXTRACT(DAY FROM t.REP_TIME) = #{day,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '2'.toString()">
			AND OWN_ORG_2 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '3'.toString()">
			AND OWN_ORG_3 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '4'.toString()">
			AND OWN_ORG_4 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="ly != null and ly != ''">
			AND LY = #{ly,jdbcType=VARCHAR}
		</if>
		GROUP BY t.TYPE
	</select>


	<select id="getYbaclztfxDataByDept" resultMap="ResultMap" >
		select
		nvl(sum(decode (t.STATUS ,'1010',1,0)) ,'0') as  data01,
		nvl(sum(decode (t.STATUS ,'1020',1,0)) ,'0') as  data02,
		nvl(sum(decode (t.STATUS ,'2010',1,0)) ,'0') as  data03,
		t.ORG_CODE as  data15
		from PS_TRANS t
		where EXTRACT(YEAR FROM t.REP_TIME) = #{year,jdbcType=VARCHAR}
		<if test="month != null and month != ''">
			AND EXTRACT(MONTH FROM t.REP_TIME) = #{month,jdbcType=VARCHAR}
		</if>
		<if test="day != null and day != ''">
			AND EXTRACT(DAY FROM t.REP_TIME) = #{day,jdbcType=VARCHAR}
		</if>
		<if test="ly != null and ly != ''">
			AND LY = #{ly,jdbcType=VARCHAR}
		</if>
		GROUP BY t.ORG_CODE
	</select>

	<select id="getPyzbData" resultMap="ResultMap" >
		select
		COUNT(1) as  data01,t.STATUS as  data02
		from PS_APPRS t
		where EXTRACT(YEAR FROM t.AP_TIME) = #{year,jdbcType=VARCHAR}
		<if test="month != null and month != ''">
			AND EXTRACT(MONTH FROM t.AP_TIME) = #{month,jdbcType=VARCHAR}
		</if>
		<if test="day != null and day != ''">
			AND EXTRACT(DAY FROM t.AP_TIME) = #{day,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '2'.toString()">
			AND OWN_ORG_2 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '3'.toString()">
			AND OWN_ORG_3 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '4'.toString()">
			AND OWN_ORG_4 = #{deptId,jdbcType=VARCHAR}
		</if>
		GROUP BY t.STATUS
	</select>

	<select id="getPymydData" resultMap="ResultMap" >
		select
		COUNT(1) as  data01,t.SCORE as  data02
		from PS_APPRS t
		where EXTRACT(YEAR FROM t.AP_TIME) = #{year,jdbcType=VARCHAR}
		<if test="month != null and month != ''">
			AND EXTRACT(MONTH FROM t.AP_TIME) = #{month,jdbcType=VARCHAR}
		</if>
		<if test="day != null and day != ''">
			AND EXTRACT(DAY FROM t.AP_TIME) = #{day,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '2'.toString()">
			AND OWN_ORG_2 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '3'.toString()">
			AND OWN_ORG_3 = #{deptId,jdbcType=VARCHAR}
		</if>
		<if test="deptLevel != null and deptLevel != '' and deptLevel == '4'.toString()">
			AND OWN_ORG_4 = #{deptId,jdbcType=VARCHAR}
		</if>
		GROUP BY t.SCORE
	</select>


</mapper>
